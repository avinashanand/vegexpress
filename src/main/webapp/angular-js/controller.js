'use strict';

// the storeController contains two objects:
// - store: contains the product list
// - cart: the shopping cart object
function storeController($scope,$http, $routeParams, DataService) {

    // Check the user status
	$http.get("/status")
    .then(function(response) {
    	if(response.data != 'loggedout'){
    		$scope.user = response.data;
    	}
        
    });
	// get store and cart from service
	// create store
	$scope.store = new store($http, $routeParams);
   // $scope.store = DataService.store;
    $scope.cart = DataService.cart;
    //$scope.products = [{"id":"1","name":"apple fuji","price":"220","unit":"KG","discount":"5","img":"/img/apple-fuji.jpg","qty":12,"type":"FRUITS"},{"id":"10","name":"Plum","price":"450","unit":"PIECE","discount":"4","img":"/img/plum.jpg","qty":15,"type":"FRUITS"},{"id":"11","name":"strawberry","price":"200","unit":"KG","discount":"1","img":"/img/strawberry.jpg","qty":2,"type":"FRUITS"},{"id":"12","name":"Cabbage","price":"30","unit":"KG","discount":"10","img":"/img/vegetable/cabbage.jpg","qty":10,"type":"VEGETABLES"},{"id":"13","name":"Onion","price":"20","unit":"KG","discount":"2","img":"/img/vegetable/onion.jpg","qty":30,"type":"VEGETABLES"},{"id":"14","name":"Onion (Sambar)","price":"20","unit":"KG","discount":"2","img":"/img/vegetable/onions.jpg","qty":30,"type":"VEGETABLES"},{"id":"15","name":"Tomato","price":"17","unit":"KG","discount":"2","img":"/img/vegetable/tomato.jpg","qty":25,"type":"VEGETABLES"},{"id":"16","name":"Cauliflower","price":"30","unit":"PIECE","discount":"2","img":"/img/vegetable/cauliflower.jpg","qty":20,"type":"VEGETABLES"},{"id":"17","name":"Cherry Tomato","price":"20","unit":"KG","discount":"2","img":"/img/vegetable/cherrytomato.jpg","qty":5,"type":"VEGETABLES"},{"id":"18","name":"Ladyfinger","price":"25","unit":"KG","discount":"2","img":"/img/vegetable/lf.jpg","qty":10,"type":"VEGETABLES"},{"id":"19","name":"Beans","price":"25","unit":"KG","discount":"2","img":"/img/vegetable/beans.jpg","qty":10,"type":"VEGETABLES"},{"id":"2","name":"Orange imported","price":"100","unit":"KG","discount":"5","img":"/img/oranges-imported.jpg","qty":20,"type":"FRUITS"},{"id":"20","name":"Green Capsicum","price":"25","unit":"KG","discount":"2","img":"/img/vegetable/gc.jpg","qty":10,"type":"VEGETABLES"},{"id":"21","name":"Carrot","price":"40","unit":"KG","discount":"0","img":"/img/vegetable/carrot.jpg","qty":10,"type":"VEGETABLES"},{"id":"22","name":"Cucumber ","price":"25","unit":"KG","discount":"0","img":"/img/vegetable/cucumber.jpg","qty":10,"type":"VEGETABLES"},{"id":"23","name":"Brinjal","price":"25","unit":"PIECE","discount":"0","img":"/img/vegetable/brinjal.jpg","qty":20,"type":"VEGETABLES"},{"id":"24","name":"Brinjal (Small)","price":"25","unit":"PIECE","discount":"0","img":"/img/vegetable/brinjals.jpg","qty":20,"type":"VEGETABLES"},{"id":"25","name":"Brinjal (Green)","price":"25","unit":"PIECE","discount":"0","img":"/img/vegetable/bringalg.jpg","qty":20,"type":"VEGETABLES"},{"id":"26","name":"Lemon","price":"5","unit":"PIECE","discount":"0","img":"/img/vegetable/lemmon.jpg","qty":50,"type":"VEGETABLES"},{"id":"27","name":"Sarso ka Saag","price":"20","unit":"PIECE","discount":"0","img":"/img/vegetable/sarsoo.jpg","qty":20,"type":"VEGETABLES"},{"id":"28","name":"Bottle Gourd (Lauki)","price":"30","unit":"PIECE","discount":"0","img":"/img/vegetable/lauki.jpg","qty":50,"type":"VEGETABLES"},{"id":"29","name":"Mint Leaves","price":"5","unit":"PIECE","discount":"0","img":"/img/vegetable/mint.jpg","qty":10,"type":"VEGETABLES"},{"id":"3","name":"Potato","price":"20","unit":"KG","discount":"2","img":"/img/potato.jpg","qty":100,"type":"VEGETABLES"},{"id":"30","name":"Curry Leaves","price":"5","unit":"PIECE","discount":"0","img":"/img/vegetable/cl.jpg","qty":10,"type":"VEGETABLES"},{"id":"31","name":"Spinach (Palak)","price":"20","unit":"PIECE","discount":"0","img":"/img/vegetable/palak.jpg","qty":10,"type":"VEGETABLES"},{"id":"32","name":"Coriander (Dhania)","price":"10","unit":"PIECE","discount":"0","img":"/img/vegetable/dhaniya.jpg","qty":10,"type":"VEGETABLES"},{"id":"33","name":"Spring Onion (Pyaz ka Patta)","price":"25","unit":"PIECE","discount":"0","img":"/img/vegetable/springo.jpg","qty":10,"type":"VEGETABLES"},{"id":"34","name":"Ginger / Adrak","price":"40","unit":"GRAM","discount":"0","img":"/img/vegetable/adrak.jpg","qty":10,"type":"VEGETABLES"},{"id":"35","name":"Fenugreek / Methi","price":"20","unit":"PIECE","discount":"0","img":"/img/vegetable/methi.jpg","qty":10,"type":"VEGETABLES"},{"id":"36","name":"Radish White / Muli","price":"10","unit":"PIECE","discount":"0","img":"/img/vegetable/muli.jpg","qty":50,"type":"VEGETABLES"},{"id":"37","name":"Peeled Garlic","price":"100","unit":"KG","discount":"0","img":"/img/vegetable/pg.jpg","qty":30,"type":"VEGETABLES"},{"id":"38","name":"Fresh Garlic","price":"100","unit":"KG","discount":"0","img":"/img/vegetable/fg.jpg","qty":30,"type":"VEGETABLES"},{"id":"39","name":"Beetroot","price":"40","unit":"KG","discount":"0","img":"/img/vegetable/beetroot.jpg","qty":15,"type":"VEGETABLES"},{"id":"4","name":"Green Grapes","price":"100","unit":"KG","discount":"2","img":"/img/green-grapes.jpg","qty":7,"type":"FRUITS"},{"id":"40","name":"Beans Cluster / Guar","price":"100","unit":"KG","discount":"0","img":"/img/vegetable/guar.jpg","qty":15,"type":"VEGETABLES"},{"id":"41","name":"Coccinia / Tondli","price":"90","unit":"KG","discount":"0","img":"/img/vegetable/tondli.jpg","qty":10,"type":"VEGETABLES"},{"id":"42","name":"Drumstick","price":"50","unit":"KG","discount":"0","img":"/img/vegetable/drumstick.jpg","qty":5,"type":"VEGETABLES"},{"id":"43","name":"Colocasia / Arbi","price":"80","unit":"KG","discount":"0","img":"/img/vegetable/arbi.jpg","qty":5,"type":"VEGETABLES"},{"id":"44","name":"Aamla ","price":"60","unit":"KG","discount":"0","img":"/img/vegetable/amla.jpg","qty":5,"type":"VEGETABLES"},{"id":"45","name":"Coconut","price":"30","unit":"PIECE","discount":"0","img":"/img/vegetable/coconut.jpg","qty":30,"type":"VEGETABLES"},{"id":"46","name":"Babycorn","price":"50","unit":"PIECE","discount":"0","img":"/img/vegetable/bcorn.jpg","qty":10,"type":"VEGETABLES"},{"id":"47","name":"SweetPotato","price":"50","unit":"KG","discount":"0","img":"/img/vegetable/sp.jpg","qty":10,"type":"VEGETABLES"},{"id":"48","name":"Bitter Gourd / Karela ","price":"80","unit":"KG","discount":"0","img":"/img/vegetable/bg.jpg","qty":10,"type":"VEGETABLES"},{"id":"49","name":"Green Chilli","price":"1","unit":"PIECE","discount":"0","img":"/img/vegetable/chilli.jpg","qty":200,"type":"VEGETABLES"},{"id":"5","name":"Avocado","price":"300","unit":"KG","discount":"1","img":"/img/avocado.png","qty":15,"type":"FRUITS"},{"id":"50","name":"Sponge Gourd / Ghosale","price":"80","unit":"KG","discount":"0","img":"/img/vegetable/ghosala.jpg","qty":200,"type":"VEGETABLES"},{"id":"51","name":"Ridge Gourd / Dodka","price":"80","unit":"KG","discount":"0","img":"/img/vegetable/dodka.jpg","qty":200,"type":"VEGETABLES"},{"id":"52","name":"Pumpkin","price":"50","unit":"PIECE","discount":"0","img":"/img/vegetable/pumpkin.png","qty":5,"type":"VEGETABLES"},{"id":"53","name":"Broccoli","price":"100","unit":"KG","discount":"0","img":"/img/vegetable/bro.jpg","qty":5,"type":"VEGETABLES"},{"id":"54","name":"Zucchini Yellow","price":"40","unit":"KG","discount":"0","img":"/img/vegetable/zy.jpg","qty":5,"type":"VEGETABLES"},{"id":"55","name":"Zucchini Green","price":"40","unit":"KG","discount":"0","img":"/img/vegetable/zg.jpg","qty":5,"type":"VEGETABLES"},{"id":"6","name":"apple irani","price":"140","unit":"KG","discount":"2","img":"/img/apple-irani.jpg","qty":15,"type":"FRUITS"},{"id":"7","name":"Banana","price":"129","unit":"KG","discount":"10","img":"/img/banana-yellaki.jpg","qty":15,"type":"FRUITS"},{"id":"8","name":"Blueberry","price":"350","unit":"PIECE","discount":"1","img":"/img/blueberry.jpg","qty":15,"type":"FRUITS"},{"id":"9","name":"kiwi","price":"70","unit":"PIECE","discount":"3","img":"/img/kiwi.jpg","qty":15,"type":"FRUITS"}];
    $scope.submit = function(){
    	if($scope.email && $scope.password){
    		$http({
    			method: 'POST',
    			headers: {'Content-Type': 'application/x-www-form-urlencoded'},
    			data: $.param({
    	            email: $scope.email,
    	            password: $scope.password
    	        }),
    			url: '/login'
    		}).then(function(response){
    				console.log(JSON.stringify(response.data));
    				$scope.user =  response.data; 
                });	
    	}
    }
}
